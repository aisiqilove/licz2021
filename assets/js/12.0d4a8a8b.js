(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{518:function(e,t,a){"use strict";a.r(t);var n=a(6),i=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("blockquote",[a("p",[e._v("众所周知，国内 GitHub 的加载速度不太理想，而大多数开发者会使用 Github 的 Github Page 功能搭建博客，因此博客的访问速度也会受到影响。为了解决访问速度的问题，我们将博客转移到了 gitee 中（ OSChina 旗下 git 平台）")])]),e._v(" "),a("h3",{attrs:{id:"_1-问题-使用-hexo-部署到-gitee-后-博客页面并没有更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-问题-使用-hexo-部署到-gitee-后-博客页面并没有更新"}},[e._v("#")]),e._v(" 1. 问题：使用 hexo 部署到 gitee 后，博客页面并没有更新")]),e._v(" "),a("ul",[a("li",[e._v("原因： gitee page 只有付费版才能自动更新，免费版只能手动点击 “设置” 中的更新按钮")])]),e._v(" "),a("h3",{attrs:{id:"_2-自动化解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-自动化解决方案"}},[e._v("#")]),e._v(" 2. 自动化解决方案")]),e._v(" "),a("ul",[a("li",[e._v("使用 puppeteer 操作浏览器进行更新按钮点击。")])]),e._v(" "),a("h3",{attrs:{id:"_3-源码如下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-源码如下"}},[e._v("#")]),e._v(" 3. 源码如下:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("// 此处安装版本为 1.8.0\nconst puppeteer = require('puppeteer'); \n\nasync function giteeUpdate() {\n    const browser = await puppeteer.launch({\n        // 此处可以使用 false 有头模式进行调试, 调试完注释即可\n          headless: false,\n    });\n    const page = await browser.newPage();\n    await page.goto('https://gitee.com/login');\n    // 1. 选中账号控件\n    let accountElements = await page.$x('//*[@id=\"user_login\"]') // 此处使用 xpath 寻找控件，下同\n    // 2. 填入账号\n    await accountElements[0].type('你的 gitee 账户')\n    // 3. 选中密码控件\n    let pwdElements = await page.$x('//*[@id=\"user_password\"]')\n    // 4. 填入密码\n    await pwdElements[0].type('你的 gitee 密码')\n    // 5. 点击登录\n    let loginButtons = await page.$x('//*[@id=\"new_user\"]/div[2]/div/div/div[4]/input')\n    await loginButtons[0].click()\n    // 6. 等待登录成功\n    await page.waitFor(1000)\n    await page.goto('你的 gitee page 更新按钮页面'); // 比如： https://gitee.com/yang0033/hexo-blog/pages\n    // 7.1. 监听步骤 7 中触发的确认弹框，并点击确认\n    await page.on('dialog', async dialog => {\n        console.log('确认更新')\n        dialog.accept();\n    })\n    // 7. 点击更新按钮，并弹出确认弹窗\n    let updateButtons = await page.$x('//*[@id=\"pages-branch\"]/div[7]')\n    await updateButtons[0].click()\n    // 8. 轮询并确认是否更新完毕\n    while (true) {\n        await page.waitFor(2000)\n        try {\n            // 8.1 获取更新状态标签\n            deploying = await page.$x('//*[@id=\"pages_deploying\"]')\n            if (deploying.length > 0) {\n                console.log('更新中...')\n            } else {\n                console.log('更新完毕')\n                break;\n            }\n        } catch (error) {\n            break;\n        }\n    }\n    await page.waitFor(500);\n    // 10.更新完毕，关闭浏览器\n    browser.close();\n}\n\ngiteeUpdate();\n")])])])])}),[],!1,null,null,null);t.default=i.exports}}]);